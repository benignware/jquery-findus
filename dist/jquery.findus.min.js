/*! jquery-findus 02-06-2016 */
!function(a){function b(b,f){function g(a){x.resize()}function h(a){o=q.getCenter()}function i(a){if((w.content||w.address)&&s){var b=s.getMap();b?s.close():s.open(q,r)}}function j(){s.close()}function k(){var c=a.extend(!0,{},w.marker,{map:q,position:o}),d=r&&r.getPosition()||null;r?r.setOptions(c):(r=new google.maps.Marker(c),google.maps.event.addListener(r,"click",i)),l(),clearTimeout(t),w.info&&w.autoShow&&!s.getMap()&&(!d||d.lat()!==o.lat()&&d.lng()!==o.lng())&&(t=setTimeout(function(){s.open(q,r),a(b).find('img[src*="gstatic.com/"], img[src*="googleapis.com/"]').css("max-width","none"),r.setAnimation(null)},r.getAnimation()?700:350))}function l(){var b;w.info?(b=a.extend(!0,{},w.info,{content:w.content||w.address&&a.trim(w.address).split(",").join("<br/>")||function(a,b){return d[a+","+b]?d[a+","+b][0].formatted_address.split(",").join("<br/>"):void 0}(w.latitude,w.longitude)}),s?s.setOptions(b):s=new google.maps.InfoWindow(b)):s&&infowindow.close()}function m(){if(o){var c=a.extend(!0,{},w.map||v.map,{center:o});q?q.setOptions(c):(n(),q=new google.maps.Map(b,c),google.maps.event.addListener(q,"click",j)),google.maps.event.addListenerOnce(q,"tilesloaded",function(){k()})}}function n(){"function"==typeof w.minHeight?w.minHeight.call(this,f):w.minHeight,"function"==typeof w.maxHeight?w.maxHeight.call(this,f):w.maxHeight;a(b).css("min-height",w.minHeight||""),a(b).css("max-height",w.maxHeight||""),a(b).css("color","black")}if(!google||!google.maps)return void console.error("jquery-findus needs Google Maps API");var o,p,q,r,s,t,u,v={address:"",autoShow:!0,bindResize:!0,content:"",info:{},map:{zoom:14,mapTypeId:google.maps.MapTypeId.ROADMAP,disableDefaultUI:!0,draggable:!1,zoomControl:!1,scrollwheel:!1,disableDoubleClickZoom:!0},marker:{},minWidth:0,minHeight:440},w={},x=this,y=a(b),z=y.html().replace(/^\s+|\s+$/g,"");this.update=function(b){if(a.extend(w,b),google.maps.Geocoder&&google.maps.LatLng){if(u=u||new google.maps.Geocoder,w.latitude&&w.longitude)o=new google.maps.LatLng(w.latitude,w.longitude),w.content&&w.address?m():u.geocode({latLng:o},function(a,b){b===google.maps.GeocoderStatus.OK?(d[w.latitude+","+w.longitude]=a,m()):console.warn("Geocoder returned with error: ",b)});else if(w.content||w.address){var e=a.map((w.address||w.content&&function(b){return b.match(/<address/)&&a("<div>"+b+"</div>").find("address").html()||b}(w.content)).split(/<(?:.|\n)*?>/gm),function(b){var c=a.trim(b);return c||null}).join(",");e=e.replace(/\+\s*\d+[-\d\s\(\)]+/gi,""),e=e.replace(/phone/gi,""),c[e]?(o=c[e][0].geometry.location,m()):u.geocode({address:e},function(a,b){b===google.maps.GeocoderStatus.OK?(c[e]=a,o=c[e][0].geometry.location,m()):console.warn("Geocoder returned with error '"+b+"' for string '"+e+"'")})}this.resize()}},this.setOptions=function(a){this.update(a)},this.getOptions=function(){return a.extend({},w)},this.resize=function(){(w.latitude&&w.longitude||w.address||w.content)&&n(),q&&(google.maps.event.clearListeners(q,"center_changed"),window.clearTimeout(p),p=window.setTimeout(function(){q.setCenter(o),google.maps.event.addListener(q,"center_changed",h)},0),google.maps.event.trigger(q,"resize"))},y.html("");var w=a.extend(!0,{},v,f,{content:z},e(y.data(),["map","marker","info"]));this.update(w),a(window).off("resize",g),w.bindResize&&a(window).on("resize",g)}var c={},d={},e=function(a,b){var c,d,e,f;for(c in a)for(d=0;d<b.length;d++)e=b[d],c.substring(0,e.length)===e&&c.length>e.length&&(f=c.substring(e.length,e.length+1).toLowerCase()+c.substring(e.length+1),a[e]=a[e]||{},a[e][f]=a[c],delete a[c]);return a};a.fn.findus=function(){var c=[].slice.call(arguments);return this.each(function(){return function(d){var e;return a(this).data("findus",d=d?"object"==typeof c[0]&&d.update(c[0])&&d||d:new b(this,c[0])),e="string"==typeof c[0]&&"function"==typeof d[c[0]]?d[c[0]].apply(d,c.slice(1)):e,"undefined"!=typeof e?e:this}.call(this,a(this).data("findus"))})},a(document).on("show.bs.tab show.bs.modal show.bs.collapse",function(b){var c,d=a(b.target);d=a(d.attr("data-target")||(c=d.attr("href"))&&c.replace(/.*(?=#[^\s]+$)/,"")||b.target),d.css("display","block").find("*").map(function(){return a(this).data("findus")||null}).each(function(){this.resize()}),d.css("display","")})}(jQuery);