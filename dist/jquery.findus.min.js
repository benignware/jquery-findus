/*! jquery-findus 09-04-2015 */
!function(a){function b(b,c){function h(a){x.resize()}function i(a){p=r.getCenter()}function j(a){if(c.content||c.address){var b=t.getMap();b?t.close():t.open(r,s)}}function k(){t.close()}function l(){var b=a.extend(!0,{},c.marker,{map:r,position:p}),e=s&&s.getPosition()||null;s?s.setOptions(b):(s=new d.maps.Marker(b),d.maps.event.addListener(s,"click",j)),m(),clearTimeout(u),!c.autoShow||t.getMap()||e&&(e.lat()===p.lat()||e.lng()===p.lng())||(u=setTimeout(function(){t.open(r,s),s.setAnimation(null)},s.getAnimation()?700:350))}function m(){var b=a.extend(!0,{},c.info,{content:c.content||c.address&&a.trim(c.address).split(",").join("<br/>")||function(a,b){return f[a+","+b]?f[a+","+b][0].formatted_address.split(",").join("<br/>"):void 0}(c.latitude,c.longitude)});t?t.setOptions(b):t=new d.maps.InfoWindow(b)}function n(){if(p){var e=a.extend(!0,{},c.map,{center:p});r?r.setOptions(e):(o(),r=new d.maps.Map(b,e),d.maps.event.addListener(r,"click",k)),d.maps.event.addListenerOnce(r,"tilesloaded",function(){l()})}}function o(){"function"==typeof c.minHeight?c.minHeight.call(this,c):c.minHeight,"function"==typeof c.maxHeight?c.maxHeight.call(this,c):c.maxHeight;a(b).css("min-height",c.minHeight||""),a(b).css("max-height",c.maxHeight||"")}if(!d||!d.maps)return void console.warn("Google maps not found");var p,q,r,s,t,u,v,w={address:"",autoShow:!0,bindResize:!0,content:"",info:{},map:{zoom:14,mapTypeId:d.maps.MapTypeId.ROADMAP,disableDefaultUI:!0,draggable:!0,zoomControl:!1,scrollwheel:!1,disableDoubleClickZoom:!0},marker:{},minWidth:0,minHeight:420},x=this,y=a(b);this.refresh=function(){if(v=v||new d.maps.Geocoder,c.latitude&&c.longitude)p=new d.maps.LatLng(c.latitude,c.longitude),c.content&&c.address?n():v.geocode({latLng:p},function(a,b){b===d.maps.GeocoderStatus.OK?(f[c.latitude+","+c.longitude]=a,n()):console.warn("Geocoder returned with error: ",b)});else if(c.content||c.address){var b=a.map((c.address||c.content&&function(b){return b.match(/<address/)&&a("<div>"+b+"</div>").find("address").html()||b}(c.content)).split(/<(?:.|\n)*?>/gm),function(b){var c=a.trim(b);return c||null}).join(",");e[b]?(p=e[b][0].geometry.location,n()):v.geocode({address:b},function(a,c){c===d.maps.GeocoderStatus.OK?(e[b]=a,p=e[b][0].geometry.location,n()):console.warn("Geocoder returned with error '"+c+"' for string '"+b+"'")})}this.resize()},this.setOptions=function(b){c=a.extend({},c,b),this.refresh()},this.getOptions=function(){return a.extend({},c)},this.resize=function(){var a=this.getOptions();(a.latitude&&a.longitude||a.address||a.content)&&o(),r&&(d.maps.event.clearListeners(r,"center_changed"),window.clearTimeout(q),q=window.setTimeout(function(){r.setCenter(p),d.maps.event.addListener(r,"center_changed",i)},0),d.maps.event.trigger(r,"resize"))},c=a.extend(!0,{},w,c,{content:y.html().replace(/^\s+|\s+$/g,"")},g(y.data(),["map","marker","info"])),y.html(""),a(window).off("resize",h),c.bindResize&&a(window).on("resize",h),this.refresh()}var c="findus",d=window.google,e={},f={},g=(function(){var a={};return function(b){return a[b]=a[b]||function(){return b.replace(/(\-[a-z])/g,function(a){return a.toUpperCase().replace("-","")})}()}}(),function(){var a={};return function(b){return a[b]=a[b]||function(){return b.replace(/([A-Z])/g,function(a){return"-"+a.toLowerCase()})}()}}(),function(a,b){var c,d,e,f;for(c in a)for(d=0;d<b.length;d++)e=b[d],c.substring(0,e.length)===e&&c.length>e.length&&(f=c.substring(e.length,e.length+1).toLowerCase()+c.substring(e.length+1),a[e]=a[e]||{},a[e][f]=a[c],delete a[c]);return a});jQuery.fn[c]=function(d){return this.each(function(){var e=a(this).data(c);return e?e.setOptions(d):e=a(this).data(c,new b(this,d)),a(this)})},a(document).on("show.bs.tab show.bs.modal show.bs.collapse",function(b){var d,e=a(b.target);e=a(e.attr("data-target")||(d=e.attr("href"))&&d.replace(/.*(?=#[^\s]+$)/,"")||b.target),e.css("display","block").find("*").map(function(){return a(this).data(c)||null}).each(function(){this.resize()}),e.css("display","")})}(jQuery);